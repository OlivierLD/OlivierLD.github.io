<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Using templates</title>

	<link rel="icon" type="image/png" href="../logo-192x192.png">

	<link rel="stylesheet" href="css/stylesheet.css">
	<link rel="stylesheet" href="css/web-components.css">
	<link rel="stylesheet" href="css/css.01.css">

	<!-- Debug -->
	<script type="module" src="widgets/calendar/CalendarDisplay.js"></script>
	<script type="module" src="widgets/splitflap/SplitFlapDisplay.js"></script>

	<link rel="import" id="import-01" href="templates/calendar.template.html">
	<link rel="import" id="import-02" href="templates/split.flap.template.html">
	<link rel="import" id="import-03" href="templates/svg.clock.template.html">

</head>
<body class="bg-img">

	<h1 class="black-frame outline">These are Web Components in HTML Templates</h1>
	<h3 class="black-frame outline">This is not working as it used to...</h3>

	<div style="display: grid; grid-template-areas: 'left right' 'bottom bottom'; grid-gap: 10px;">
		<div id="calendar-placeholder" style="grid-area: left; vertical-align: top; text-align: center; padding-top: 55px;">
			<!--iframe src="./templates/calendar.template.html" style="height: 300px; width: 100%;"></iframe-->
		</div>
		<div id="svg-clock-placeholder" style="grid-area: right; vertical-align: top;">
			<iframe src="./templates/svg.clock.template.html" style="height: 300px; width: 400px;"></iframe>
		</div>
		<div id="split-flap-placeholder" style="grid-area: bottom;">
			<!--iframe src="./templates/split.flap.template.html" style="height: 300px; width: 100%;"></iframe-->
		</div>
	</div>

	<script>

	async function loadTemplate (filename, where) {
		const res = await fetch(filename);
		const text = await res.text();
		console.log("Inserting template from [%s] into [%s]", filename, where);
		// console.log(text);
		document.getElementById(where).insertAdjacentHTML('afterend', text); // See https://www.w3schools.com/jsref/met_node_insertadjacenthtml.asp
	}

	window.onload = () => {

		let linkCal = document.querySelector('link[rel="import"][id="import-01"]'); // Simplify this, is [rel="import"] necessary?
		let contentCal = linkCal.href;

		let linkSF = document.querySelector('link[rel="import"][id="import-02"]');
		let contentSF = linkSF.href;

		let linkClk = document.querySelector('link[rel="import"][id="import-03"]');
		let contentClk = linkClk.href;

		if (true) {
			loadTemplate(contentCal, "calendar-placeholder").then( () => {
				console.log("Calendar template loaded.");
			});
		}

		if (true) {
			loadTemplate(contentSF, "split-flap-placeholder").then( () => {
				console.log("Split Flap template loaded.");
			});
		}

		if (false) {
			loadTemplate(contentClk, "svg-clock-placeholder").then( () => {
				console.log("SVG Clock template loaded.");
			});
		}
	};


// window.onload = () => {
// 	updateCalendar();
// };
	</script>

	<hr/>
	<small>Take a look at the page source, it's really worth it.</small>

</body>
</html>
