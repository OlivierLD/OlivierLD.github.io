<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>9 &Eacute;toiles</title>
	<link rel="icon" type="image/png" href="./stars-group.png">
	<!--link rel="stylesheet" href="../../css/stylesheet.css"-->
	<style type="text/css">
* {
    font-family: 'Courier New', Courier, monospace;
    /*font-size: 2em;*/
}        

*:focus {
    text-shadow: 2px 2px 4px black, 0 0 25px white, 0 0 10px orange;
}

body {
    background-color: silver;
    font-size: 2em;
}
h1 {
    color: navy;
    text-shadow: 2px 2px 4px black, 0 0 25px white, 0 0 10px orange;
}
input, select, button {
    font-size: 1.5em;
    border-radius: 6px;
}
button {
  padding: 4px 20px;
  /* give the background a gradient */
  background: #ffae00; /* fallback for browsers that don't support gradients */
  background: -webkit-linear-gradient(top, #ffae00, #d67600);
  background: -moz-linear-gradient(top, #ffae00, #d67600);
  background: -o-linear-gradient(top, #ffae00, #d67600);
  background: linear-gradient(top, #ffae00, #d67600);
  border: 2px outset #dad9d8;
  /* style the text */
  font-family: Lato, Verdana, Andika, Arial, sans-serif; /* Andkia is available at http://www.google.com/webfonts/specimen/Andika */
  font-size: 0.8em;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: #fff;
  text-shadow: 0 1px 10px #000;
  /* add to small curve to the corners of the button */
  -webkit-border-radius: 15px;
  -moz-border-radius: 15px;
  border-radius: 15px;
  /* give the button a drop shadow */
  -webkit-box-shadow: rgba(0, 0, 0, .55) 0 1px 6px;
  -moz-box-shadow: rgba(0, 0, 0, .55) 0 1px 6px;
  box-shadow: rgba(0, 0, 0, .55) 0 1px 6px;
}

/* NOW STYLE THE BUTTON'S HOVER STATE */
button:hover, button:focus {
  border: 2px solid #dad9d8;
}


    </style>
    <script type="text/javascript">

/*
Olivier né le 06/03/1959

L’année correspond à l’élément adulte. Pour les chinois, nous passons à l’âge adulte lorsque nous devenons autonomes, 
indépendants financièrement; c’est pourquoi une femme au foyer par exemple, sera le plus souvent sous l’influence de 
son élément enfant; c’est sur lui qu’elle va se reposer.

Donc: 1+9+5+9= 24 -> 2+4=6 11-6=5 => Terre 5
Ou
29/06/1964 => 1+9+6+4 = 20 11-2=9 => Feu

9 étoiles:
1 Eau; 2 Terre; 3 Bois; 4 Bois; 5 Terre; 6 Métal; 7 Métal; 8 Terre; 9 Feu

Pour l’élément enfant il n’y a pas de calcul, il dépend de ton élément adulte et du jour et mois de naissance, les 2 combinés.

 */

        const NINE_STARS = [
          "Eau",   // 1
          "Terre", // 2 
          "Bois",  // 3
          "Bois",  // 4
          "Terre", // 5
          "Métal", // 6
          "Métal", // 7
          "Terre", // 8
          "Feu"    // 9
        ];

        let findAdult = (year) => {
            let index = 0;
            let finalStr = year;
            while (finalStr.length > 1) {
                let sum = 0;
                for (let i=0; i<finalStr.length; i++) {
                    sum += (parseInt(finalStr.substring(i, i+1)));
                }
                console.log(`Sum: ${sum}`);
                finalStr = sum.toFixed(0);
            }
            index = parseInt(finalStr);

            return 11 - index;
        };

        const NB_DAY = [
            31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31
        ];
        const JAN = 1;
        const FEB = 2;
        const MAR = 3;
        const APR = 4;
        const MAY = 5;
        const JUN = 6;
        const JUL = 7;
        const AUG = 8;
        const SEP = 9;
        const OCT = 10;
        const NOV = 11;
        const DEC = 12;

        const MONTHS = [
            "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
        ];

        let birthBetween = (birthMonth, birthDay, fromMonth, fromDay, toMonth, toDay) => {
            let fromNbDay = fromDay;
            for (let i=0; i<(fromMonth - 1); i++) {
                fromNbDay += NB_DAY[i];
            }
            let toNbDay = toDay;
            for (let i=0; i<(toMonth - 1); i++) {
                toNbDay += NB_DAY[i];
            }
            let birthNbDay = birthDay;
            for (let i=0; i<(birthMonth - 1); i++) {
                birthNbDay += NB_DAY[i];
            }
            if (toMonth < fromMonth) {
                toNbDay += 365;
                if (birthMonth < fromMonth) {
                    birthNbDay += 365;
                }
            }
            console.log(`Birth ${birthDay} ${MONTHS[birthMonth -1]}: Day #${birthNbDay}`);
            console.log(`From  ${fromDay} ${MONTHS[fromMonth -1]}: Day #${fromNbDay}`);
            console.log(`To    ${toDay} ${MONTHS[toMonth -1]}: Day #${toNbDay}`);

            return (birthNbDay >= fromNbDay && birthNbDay <= toNbDay);
        };

        let findYouth = (adultIndex, month, day) => {
            let index = 0;

            if (birthBetween(month, day, FEB, 4, MAR, 5)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 8;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 2;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 5;
                }
            } else if (birthBetween(month, day, MAR, 6, APR, 4)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 7;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 1;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 4;
                }
            } else if (birthBetween(month, day, APR, 5, MAY, 5)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 6;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 9;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 3;
                }
            } else if (birthBetween(month, day, MAY, 6, JUN, 5)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 5;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 8;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 2;
                }
            } else if (birthBetween(month, day, JUN, 6, JUL, 7)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 4;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 7;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 1;
                }
            } else if (birthBetween(month, day, JUL, 8, AUG, 7)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 3;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 6;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 9;
                }
            } else if (birthBetween(month, day, AUG, 8, SEP, 7)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 2;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 5;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 8;
                }
            } else if (birthBetween(month, day, SEP, 8, OCT, 8)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 1;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 4;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 7;
                }
            } else if (birthBetween(month, day, OCT, 9, NOV, 7)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 9;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 3;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 6;
                }
            } else if (birthBetween(month, day, NOV, 8, DEC, 7)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 8;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 2;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 5;
                }
            } else if (birthBetween(month, day, DEC, 8, JAN, 5)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 7;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 1;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 4;
                }
            } else if (birthBetween(month, day, JAN, 6, FEB, 3)) {
                if (adultIndex === 1 || adultIndex === 4 || adultIndex === 7) {
                    index = 6;
                } else if (adultIndex === 2 || adultIndex === 5 || adultIndex === 8) {
                    index = 9;
                } else if (adultIndex === 3 || adultIndex === 6 || adultIndex === 9) {
                    index = 3;
                }
            }
            return index;
        };

        let process = () => {
            let yearValue = document.getElementById('year-value').value;
            if (yearValue.trim().length === 0) {
                alert('Saisir au moins une année... Merci.');
                return;
            }
            let monthValue = document.getElementById('month-value').value;
            let dayValue = document.getElementById('day-value').value;

            console.log(`Read year ${yearValue}`);
            let adultIndex = findAdult(yearValue);
            let adultElement = `${NINE_STARS[adultIndex - 1]} ${adultIndex}`;
            console.log(`Adult: ${adultElement}`);
            let childIndex = findYouth(adultIndex, parseInt(monthValue), parseInt(dayValue));
            let childElement = `${NINE_STARS[childIndex - 1]} ${childIndex}`;

            let htmlContent = `&Eacute;l&eacute;ment adulte : ${adultElement}` + 
                              '<br/>' +
                              `&Eacute;l&eacute;ment enfant : ${childElement}`;
            document.getElementById('result').innerHTML = htmlContent;
        };

    </script>
</head>
<body>
    <h1>9 &Eacute;toiles...</h1>
    <span>Date de naissance&nbsp;:</span>
    <input id="year-value" type="number" min="0" placeholder="Year" title="Ann&eacute;e de naissance" style="text-align: right; width: 200px;"/>
    <select id="month-value" title="Mois de naissance">
        <option value="1" selected>Jan</option>
        <option value="2">Feb</option>
        <option value="3">Mar</option>
        <option value="4">Apr</option>
        <option value="5">May</option>
        <option value="6">Jun</option>
        <option value="7">Jul</option>
        <option value="8">Aug</option>
        <option value="9">Sep</option>
        <option value="10">Oct</option>
        <option value="11">Nov</option>
        <option value="12">Dec</option>
    </select>
    <input id="day-value" type="number" min="1" max="31" placeholder="day" title="Jour du mois de naissance" style="text-align: right; width: 100px;" value="1"/>
    <br/>
    <button onclick="process();" style="border-radius: 5px; margin: 5px;" title="En avant !">Calcul</button>
    <hr/>
    <div id="result">

    </div>
    <hr/>
    <i><small style="color: cyan;">OlivSoft never stops</small></i>
</body>
<script type="text/javascript">

window.onload = () => {
    console.log("Loaded.");
};

</script>
</html>
